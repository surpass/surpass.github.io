---
categories:
- 技术文章
date: '2008-05-20'
title: 开源Granados介绍 - SSH连接远程Linux服务器(C#)
url: /2008/05/20/1203574/

---


Granados是一个基于.NET的SSH客户端库。它有以下特点：

1.Granados是一个C#的开源项目。源码地址：[http://www.routrek.co.jp/support/download/varaterm/granados200.tar.gz](http://www.routrek.co.jp/support/download/varaterm/granados200.tar.gz)

2.同时支持SSH1和SSH2。

3.Granados实现了AES, Blowfish, TripleDES, RSA, DSA等加密验证算法。

4.实现TCP协议连接。

### 如何使用Granados库

可惜的是Granados的文档几乎没有！所以只有从它的源码找到它的测试代码来看。总结步骤为：

1.工程中添加Routrek.granados.dll(下载的包里有)的引用。

2.添加Reader类，实现ISSHConnectionEventReceiver和ISSHChannelEventReceiver接口。首先引用命名空间：

<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; background-color: #eeeeee; font-size: 13px; width: 98%;"><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;System.Threading;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;System.Diagnostics;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;System.Net;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;System.Net.Sockets;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;Routrek.Crypto;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;Routrek.SSHC;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;Routrek.SSHCV1;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;Routrek.SSHCV2;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;Routrek.Toolkit;

</span><span style="color: #0000ff;">using</span><span style="color: #000000;">&nbsp;Routrek.PKI;</span></div>

Reader类实现如下：

<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; background-color: #eeeeee; font-size: 13px; width: 98%;"><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;Reader&nbsp;:&nbsp;ISSHConnectionEventReceiver,&nbsp;ISSHChannelEventReceiver

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_73_2356_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_73_2356_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;SSHConnection&nbsp;_conn;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">bool</span><span style="color: #000000;">&nbsp;_ready;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnData(</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;offset,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;length)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_212_305_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_212_305_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Console.Write(Encoding.ASCII.GetString(data,&nbsp;offset,&nbsp;length));

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnDebugMessage(</span><span style="color: #0000ff;">bool</span><span style="color: #000000;">&nbsp;always_display,&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_383_467_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_383_467_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">DEBUG:&nbsp;</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;Encoding.ASCII.GetString(data));

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnIgnoreMessage(</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_525_610_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_525_610_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Ignore:&nbsp;</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;Encoding.ASCII.GetString(data));

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnAuthenticationPrompt(</span><span style="color: #0000ff;">string</span><span style="color: #000000;">[]&nbsp;msg)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_676_741_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_676_741_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Auth&nbsp;Prompt&nbsp;</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;msg[</span><span style="color: #800080;">0</span><span style="color: #000000;">]);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnError(Exception&nbsp;error,&nbsp;</span><span style="color: #0000ff;">string</span><span style="color: #000000;">&nbsp;msg)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_808_865_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_808_865_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">ERROR:&nbsp;</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;msg);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnChannelClosed()

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_912_1044_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_912_1044_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Channel&nbsp;closed</span><span style="color: #800000;">"</span><span style="color: #000000;">);

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_conn.Disconnect(</span><span style="color: #800000;">""</span><span style="color: #000000;">);

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">_conn.AsyncReceive(this);</span><span style="color: #008000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnChannelEOF()

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1088_1168_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1088_1168_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_pf.Close();

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Channel&nbsp;EOF</span><span style="color: #800000;">"</span><span style="color: #000000;">);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnExtendedData(</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;type,&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1235_1292_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1235_1292_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">EXTENDED&nbsp;DATA</span><span style="color: #800000;">"</span><span style="color: #000000;">);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnConnectionClosed()

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1342_1403_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1342_1403_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Connection&nbsp;closed</span><span style="color: #800000;">"</span><span style="color: #000000;">);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnUnknownMessage(</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">&nbsp;type,&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1473_1540_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1473_1540_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Unknown&nbsp;Message&nbsp;</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;type);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnChannelReady()

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1586_1624_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1586_1624_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ready&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">;

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnChannelError(Exception&nbsp;error,&nbsp;</span><span style="color: #0000ff;">string</span><span style="color: #000000;">&nbsp;msg)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1697_1762_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1697_1762_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Channel&nbsp;ERROR:&nbsp;</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;msg);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnMiscPacket(</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">&nbsp;type,&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;offset,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;length)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1852_1863_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_1852_1863_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;PortForwardingCheckResult&nbsp;CheckPortForwardingRequest(</span><span style="color: #0000ff;">string</span><span style="color: #000000;">&nbsp;host,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;port,&nbsp;</span><span style="color: #0000ff;">string</span><span style="color: #000000;">&nbsp;originator_host,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;originator_port)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_2009_2177_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_2009_2177_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PortForwardingCheckResult&nbsp;r&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;PortForwardingCheckResult();

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.allowed&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.channel&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">this</span><span style="color: #000000;">;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;r;

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;EstablishPortforwarding(ISSHChannelEventReceiver&nbsp;rec,&nbsp;SSHChannel&nbsp;channel)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_2280_2318_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_2280_2318_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_pf&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;channel;

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;SSHChannel&nbsp;_pf;

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div>

3.好的，现在来测试一下：

<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; background-color: #eeeeee; font-size: 13px; width: 98%;"><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;Program

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_18_1116_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_18_1116_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">private</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">static</span><span style="color: #000000;">&nbsp;SSHConnection&nbsp;_conn;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">static</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;Main(</span><span style="color: #0000ff;">string</span><span style="color: #000000;">[]&nbsp;args)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_112_1110_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_112_1110_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSHConnectionParameter&nbsp;f&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;SSHConnectionParameter();

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.UserName&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">root</span><span style="color: #800000;">"</span><span style="color: #000000;">;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.Password&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">****</span><span style="color: #800000;">"</span><span style="color: #000000;">;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.Protocol&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;SSHProtocol.SSH2;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.AuthenticationType&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;AuthenticationType.Password;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.WindowSize&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">0x1000</span><span style="color: #000000;">;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reader&nbsp;reader&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;Reader();

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;s&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;Socket(AddressFamily.InterNetwork,&nbsp;SocketType.Stream,&nbsp;ProtocolType.Tcp);

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.Connect(</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;IPEndPoint(IPAddress.Parse(</span><span style="color: #800000;">"</span><span style="color: #800000;">192.168.x.x</span><span style="color: #800000;">"</span><span style="color: #000000;">),&nbsp;</span><span style="color: #800080;">22</span><span style="color: #000000;">));

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_conn&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;SSHConnection.Connect(f,&nbsp;reader,&nbsp;s);

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader._conn&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;_conn;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSHChannel&nbsp;ch&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;_conn.OpenShell(reader);

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader._pf&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;ch;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSHConnectionInfo&nbsp;ci&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;_conn.ConnectionInfo;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread.Sleep(</span><span style="color: #800080;">1000</span><span style="color: #000000;">);

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;b&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[</span><span style="color: #800080;">1</span><span style="color: #000000;">];

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span style="color: #000000;">&nbsp;(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_957_1099_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">![](http://www.cnblogs.com/Images/dot.gif)</span><span id="Codehighlighter1_957_1099_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;input&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;System.Console.Read();

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[</span><span style="color: #800080;">0</span><span style="color: #000000;">]&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;(</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">)input;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader._pf.Transmit(b);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;">

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif)&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div>

4.执行效果如下：

![](http://www.cnblogs.com/images/cnblogs_com/coderzh/cmd.JPG)

5.如果你需要快速的执行某些指定的命令，则可以把上面的

<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; background-color: #eeeeee; font-size: 13px; width: 98%;"><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;b&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[</span><span style="color: #800080;">1</span><span style="color: #000000;">];

&nbsp;
</span><span style="color: #0000ff;">while</span><span style="color: #000000;">&nbsp;(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif)![](http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif)</span><span id="Codehighlighter1_61_203_Open_Text"><span style="color: #000000;">{

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;input&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;System.Console.Read();

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[</span><span style="color: #800080;">0</span><span style="color: #000000;">]&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;(</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">)input;

![](http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reader._pf.Transmit(b);

![](http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif) }</span></span></div>

替换为：

<div style="border: 1px solid #cccccc; padding: 4px 5px 4px 4px; background-color: #eeeeee; font-size: 13px; width: 98%;"><span style="color: #0000ff;">string</span><span style="color: #000000;">&nbsp;cmd&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">vi&nbsp;xxx.txt\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;

</span><span style="color: #0000ff;">byte</span><span style="color: #000000;">[]&nbsp;data&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;(</span><span style="color: #0000ff;">new</span><span style="color: #000000;">&nbsp;UnicodeEncoding()).GetBytes(cmd);

reader._pf.Transmit(data);</span></div>

希望当你在找一个SSH库时这篇文章对你有所帮助，谢谢！

**[温馨提示]：该文章由原博客园导入而来，如排版效果不佳，请移步：[http://www.cnblogs.com/coderzh/archive/2008/05/20/1203574.html](http://www.cnblogs.com/coderzh/archive/2008/05/20/1203574.html)**